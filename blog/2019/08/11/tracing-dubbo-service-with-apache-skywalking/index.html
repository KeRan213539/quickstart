<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Tracing Dubbo service with Apache Skywalking</title><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en-us"><meta property="og:type" content="website"><meta property="og:site_name" content="Nacos"><meta property="og:title" content="Tracing Dubbo service with Apache Skywalking"><meta property="og:url" content="/blog/2019/08/11/tracing-dubbo-service-with-apache-skywalking/"><meta property="og:image" content="/images/"><meta name=twitter:title content="Nacos"><meta name=twitter:url content="/blog/2019/08/11/tracing-dubbo-service-with-apache-skywalking/"><meta name=twitter:image content="/images/"><meta name=twitter:card content><link rel=canonical href=/blog/2019/08/11/tracing-dubbo-service-with-apache-skywalking/><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,600,400italic,700" rel=stylesheet type=text/css><link rel=stylesheet href=/css/leaflet.css><link rel=stylesheet href=/css/animate.css><link rel=stylesheet href=/css/icomoon.css><link rel=stylesheet href=/css/simple-line-icons.css><link rel=stylesheet href=/css/magnific-popup.css><link rel=stylesheet href=/css/bootstrap.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/custom1.css><link rel=stylesheet href=/css/custom2.css><link rel=stylesheet href=/css/font-awesome.min.css><script src=/js/modernizr-2.6.2.min.js></script><meta name=referrer content="no-referrer"><link rel="shortcut icon" href=https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png><script src=/js/jquery.min.js></script><script src=/js/jquery.easing.1.3.js></script><script src=/js/bootstrap.min.js></script><script src=/js/jquery.waypoints.min.js></script><script src=/js/jquery.stellar.min.js></script><script src=/js/jquery.countTo.js></script><script src=/js/jquery.magnific-popup.min.js></script><script src=/js/magnific-popup-options.js></script><script src=/js/main.js></script></head><body><header role=banner id=fh5co-header><div class=container><nav class="navbar navbar-default"><div class=navbar-header><a href=# class="js-fh5co-nav-toggle fh5co-nav-toggle" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><i></i></a><a class=navbar-brand href=index.html><img id=nacosLogo src=/images/nacos.png></a></div><div id=navbar class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a class=external href=/><span>Home</span></a></li><li><a class=external href=/docs><span>Documentation</span></a></li><li class=active><a class=external href=/blog><span>Blog</span></a></li><li><a class=external href=/community><span>Community</span></a></li><li><a class=external href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0"><span>Naco In Cloud</span></a>
<img class=menu-img src=https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png></li><li><a class=external href=http://console.nacos.io/nacos/index.html><span>Demo-Console</span></a></li><li><div class=dropdown><button class="btn btn-default dropdown-toggle" type=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
<span class=caret></span></button><ul class=dropdown-menu><li><a class=external href=/zh/blog/2019/08/11/%E4%BD%BF%E7%94%A8apache-skywalking-incubator-%E5%81%9A%E5%88%86%E5%B8%83%E5%BC%8F%E8%B7%9F%E8%B8%AA/>中文</a></li></ul></div></li><li><div class=navbar-nav><input type=search class="form-control nav-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off>
<script src=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js></script><link href=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.css rel=stylesheet><script>docsearch({appId:"3CRHI0VEW6",apiKey:"e7b36bd85080f2bcfb9de34adc766043",indexName:"nacos_test",algoliaOptions:{hitsPerPage:3},inputSelector:'.nav-search-input',debug:false});</script></div></li></ul></div></nav></div></header><section class=animated><div class="col-md-2 blogDocSidebar"><a href=# id=sidebarConsoleBtn><i class="fa fa-bars fa-fw"></i></a><div id=sidebarContent><ul><li><a href=/blog/>Blog</a></li><ul><li class="collapse show" id=blog><ul><li><a class=active href=/blog/news/>Articles</a></li><ul><li class="collapse show" id=blognews><a id=m-blog20190826service-test href=/blog/2019/08/26/service-test/>Service test in dubbo admin</a>
<a id=m-blog20190811tracing-dubbo-service-with-apache-skywalking class=active2 href=/blog/2019/08/11/tracing-dubbo-service-with-apache-skywalking/>Use apache skywalking in dubbo</a>
<a id=m-blog20190502dubbo-extensible-mechanism-source-code-analysis-part-2 href=/blog/2019/05/02/dubbo-extensible-mechanism-source-code-analysis-part-2/>Dubbo extensible mechanism - part 2</a>
<a id=m-blog20190425dubbo-extensible-mechanism-source-code-analysis-part-1 href=/blog/2019/04/25/dubbo-extensible-mechanism-source-code-analysis-part-1/>Dubbo extensible mechanism - part 1</a>
<a id=m-blog20190220implementation-background-and-practice-of-dubbo-client-asynchronous-interface href=/blog/2019/02/20/implementation-background-and-practice-of-dubbo-client-asynchronous-interface/>Dubbo Async Client</a>
<a id=m-blog20190220implementation-background-and-practice-of-dubbo-server-asynchronous-interface href=/blog/2019/02/20/implementation-background-and-practice-of-dubbo-server-asynchronous-interface/>Dubbo Async Server</a>
<a id=m-blog20190117how-to-use-seata-to-ensure-consistency-between-dubbo-microservices href=/blog/2019/01/17/how-to-use-seata-to-ensure-consistency-between-dubbo-microservices/>Use Seata in Dubbo</a>
<a id=m-blog20181210the-fifth-dubbo-meetup-has-been-held-in-hangzhou href=/blog/2018/12/10/the-fifth-dubbo-meetup-has-been-held-in-hangzhou/>The fifth Dubbo meetup</a>
<a id=m-blog20181107dubbo-integrates-with-nacos-to-become-a-registry href=/blog/2018/11/07/dubbo-integrates-with-nacos-to-become-a-registry/>Use Dubbo with Nacos</a>
<a id=m-blog20181005introduction-to-the-dubbo-protocol href=/blog/2018/10/05/introduction-to-the-dubbo-protocol/>Introduction to the Dubbo protocol</a>
<a id=m-blog20180930integrate-dubbo-with-kubernetes href=/blog/2018/09/30/integrate-dubbo-with-kubernetes/>Integrate Dubbo with Kubernetes</a>
<a id=m-blog20180902how-to-prepare-an-apache-release href=/blog/2018/09/02/how-to-prepare-an-apache-release/>How to prepare an Apache Release</a>
<a id=m-blog20180902how-to-implement-a-fully-asynchronous-calls-chain-based-on-dubbo href=/blog/2018/09/02/how-to-implement-a-fully-asynchronous-calls-chain-based-on-dubbo/>New Async Call</a>
<a id=m-blog20180826the-fourth-dubbo-meetup-has-been-held-in-chengdu href=/blog/2018/08/26/the-fourth-dubbo-meetup-has-been-held-in-chengdu/>The fourth Dubbo meetup</a>
<a id=m-blog20180814dubbo-basic-usage-dubbo-consumer-configuration href=/blog/2018/08/14/dubbo-basic-usage-dubbo-consumer-configuration/>Dubbo Consumer Configuration</a>
<a id=m-blog20180814dubbo-several-ways-about-synchronousasynchronous-invoke href=/blog/2018/08/14/dubbo-several-ways-about-synchronous/asynchronous-invoke/>Dubbo Invoke</a>
<a id=m-blog20180814dubbo-basic-usage-dubbo-provider-configuration href=/blog/2018/08/14/dubbo-basic-usage-dubbo-provider-configuration/>Dubbo Provider Configuration</a>
<a id=m-blog20180814manipulating-services-dynamically-via-qos href=/blog/2018/08/14/manipulating-services-dynamically-via-qos/>Dubbo QoS Introduction</a>
<a id=m-blog20180814source-code-analysis-of-spring-boot-dubbo-app-start-and-stop href=/blog/2018/08/14/source-code-analysis-of-spring-boot-dubbo-app-start-and-stop/>Dubbo start/stop in spring boot</a>
<a id=m-blog20180814implementation-of-cross-language-calls-by-dubbo2js href=/blog/2018/08/14/implementation-of-cross-language-calls-by-dubbo2.js/>dubbo2.js introduction</a>
<a id=m-blog20180814generic-invoke-of-dubbo href=/blog/2018/08/14/generic-invoke-of-dubbo/>Generic invoke</a>
<a id=m-blog20180810dubbos-load-balance href=/blog/2018/08/10/dubbos-load-balance/>Dubbo's Load Balance</a>
<a id=m-blog20180807use-annotations-in-dubbo href=/blog/2018/08/07/use-annotations-in-dubbo/>Use Annotations In Dubbo</a>
<a id=m-blog20180807using-zookeeper-in-dubbo href=/blog/2018/08/07/using-zookeeper-in-dubbo/>Using Zookeeper in Dubbo</a>
<a id=m-blog20180807dubbo-101 href=/blog/2018/08/07/dubbo-101/>Your First Dubbo Demo</a>
<a id=m-blog20180730the-third-dubbo-meetup-has-been-held-in-shenzhen href=/blog/2018/07/30/the-third-dubbo-meetup-has-been-held-in-shenzhen/>The third Dubbo meetup</a>
<a id=m-blog20180727sentinel-the-flow-sentinel-of-dubbo-services href=/blog/2018/07/27/sentinel-the-flow-sentinel-of-dubbo-services/>Introduce sentinel</a>
<a id=m-blog20180712tracking-with-pinpoint href=/blog/2018/07/12/tracking-with-pinpoint/>Tracking with Pinpoint</a>
<a id=m-blog20180701your-first-dubbo-filter href=/blog/2018/07/01/your-first-dubbo-filter/>Your First Dubbo Filter</a>
<a id=m-blog20180623the-second-dubbo-shanghai-meetup-has-been-held-successfully href=/blog/2018/06/23/the-second-dubbo-shanghai-meetup-has-been-held-successfully/>The second Dubbo meetup</a>
<a id=m-blog20180512the-first-dubbo-meetup-has-been-held-in-beijing href=/blog/2018/05/12/the-first-dubbo-meetup-has-been-held-in-beijing/>The first Dubbo meetup</a>
<a id=m-blog20180502the-apachecon-na-schedule-has-been-announced href=/blog/2018/05/02/the-apachecon-na-schedule-has-been-announced/>ApacheCon NA</a>
<a id=m-blog20180425the-gsocgoogle-summer-of-code-2018 href=/blog/2018/04/25/the-gsocgoogle-summer-of-code-2018/>GSoC 2018</a>
<a id=m-blog20180422dubbo-roadmap-is-announced-in-qcon-beijing-2018 href=/blog/2018/04/22/dubbo-roadmap-is-announced-in-qcon-beijing-2018/>QCon Beijing 2018</a></li></ul></ul><ul><li><a href=/blog/releases/>Releases</a></li><ul><li class=collapse id=blogreleases><a id=m-blog20200518past-releases href=/blog/2020/05/18/past-releases/>Past Releases</a></li></ul></ul></li></ul></ul></div><script>$(function(){$("#sidebarConsoleBtn").click(function(){$("#sidebarContent").toggle();});});</script></div><div class="col-md-2 blogDocToc"><div class=td-page-meta><a href="https://github.com/nacos-group/nacos-group.github.io/issues/new?title=Tracing%20Dubbo%20service%20with%20Apache%20Skywalking" target=_blank><i class="fa fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/alibaba/nacos/issues/new target=_blank><i class="fa fa-tasks fa-fw"></i>Create project issue</a></div><nav id=TableOfContents><ul><li><a href=#introduction-to-apache-skywalking>Introduction to Apache Skywalking</a></li><li><a href=#dubbo-and-apache-skywalking>Dubbo and Apache Skywalking</a><ul><li><a href=#build-the-dubbo-demo--project>Build the Dubbo demo project</a></li><li><a href=#deploy-apache-skywalking>Deploy Apache Skywalking</a></li></ul></li><li><a href=#skywalking-scren-snapshot>Skywalking scren snapshot</a><ul><li><a href=#dashboard>Dashboard</a></li><li><a href=#topology>Topology</a></li><li><a href=#application-view>Application view</a></li><li><a href=#service-view>Service view</a></li><li><a href=#trace>Trace</a></li><li><a href=#alarm-view>Alarm view</a></li></ul></li></ul></nav></div><div class=row><div class=col-md-2></div><div class="col-md-8 blogDocContent"><main role=main><a class="btn btn-lg rssIcon" href=/blog/news/index.xml target=_blank>RSS <i class="fa fa-rss ml-2"></i></a><div class=row><div class=col-md-2><ul></ul></div><div class=col-md-10></div></div><div class=td-content><h1>Tracing Dubbo service with Apache Skywalking</h1><div class=lead>This article introduces how to use Apache Skywalking to track Dubbo applications.</div><div class="td-byline mb-4"><time datetime=2019-08-11 class=text-muted>Sunday, August 11, 2019</time></div><h2 id=introduction-to-apache-skywalking>Introduction to Apache Skywalking</h2><p><a href=https://github.com/apache/incubator-skywalking>Apache Skywalking</a> is the APM system that it designed for micro-services architectures and cloud native architecture systems and supports distribute tracking. <a href=https://github.com/apache/incubator-skywalking>Apache skywalking (incubator)</a> collects and analyzes the trace data and generates the relationship between the application and the service metric, Apache skywalking supports multiple languages agent, for example <a href=https://github.com/apache/incubator-skywalking>Java</a>,<a href=https://github.com/OpenSkywalking/skywalking-netcore>.net core</a>,<a href=https://github.com/OpenSkywalking/skywalking-nodejs>Node.js</a> and <a href=https://github.com/OpenSkywalking/skywalking-go>Go</a>.</p><p>Currently, Skywalking has supported analysis the operation of distributed systems from 6 visual dimensions. The overview view is a global view of your applications and components, including the number of components and applications, application alarm fluctuations, slow service lists, and application throughput; The topology shows the topological relationship of the whole application; The application view represents the upstream and downstream relationship of the application from single application, TOP N services and servers, JVM, host and process info. The service view focuses on the operation of a single service portal and the upstream and downstream dependencies of this service and it helps the user to optimize and monitor a single service; the trace graph shows all the buried points of the invocation and the execution time of each burial point, and the alarm view is based on the configuration threshold for the application, server, service for real-time alarms</p><h2 id=dubbo-and-apache-skywalking>Dubbo and Apache Skywalking</h2><h3 id=build-the-dubbo-demo--project>Build the Dubbo demo project</h3><p>The Dubbo demo has been uploaded to the <a href=https://github.com/SkywalkingTest/dubbo-trace-example>GitHub repository</a>.</p><h4 id=api-project>API project</h4><p>Service interface definition:
package org.apache.skywalking.demo.interfaces;</p><p>public interface HelloService {
String sayHello(String name);
}</p><h4 id=service-provider-project>Service provider project</h4><p>package org.apache.skywalking.demo.provider;</p><p>@Service(version = &ldquo;${demo.service.version}&rdquo;,
application = &ldquo;${dubbo.application.id}&rdquo;,
protocol = &ldquo;${dubbo.protocol.id}&rdquo;,
registry = &ldquo;${dubbo.registry.id}&rdquo;, timeout = 60000)
public class HelloServiceImpl implements HelloService {</p><pre><code>public String sayHello(String name) {
    LockSupport.parkNanos(TimeUnit.SECONDS.toNanos(1));
    return &quot;Hello, &quot; + name;
}
</code></pre><p>}</p><h4 id=service-consumer-project>Service consumer project</h4><p>package org.apache.skywalking.demo.consumer;</p><p>@RestController
public class ConsumerController {</p><pre><code>private static int COUNT = 0;

@Reference(version = &quot;${demo.service.version}&quot;,
    application = &quot;${dubbo.application.id}&quot;,
    url = &quot;dubbo://localhost:20880&quot;, timeout = 60000)
private HelloService helloService;

@GetMapping(&quot;/sayHello/{name}&quot;)
public String sayHello(@PathVariable(name = &quot;name&quot;) String name) {
    if ((COUNT++) % 3 == 0){
        throw new RuntimeException();
    }
    LockSupport.parkNanos(TimeUnit.SECONDS.toNanos(2));
    return helloService.sayHello(name);
}
</code></pre><p>}</p><h3 id=deploy-apache-skywalking>Deploy Apache Skywalking</h3><p><a href=https://github.com/apache/incubator-skywalking>Apache skywalking</a> offers two deployment modes: single-node mode and cluster mode,Here is the single-node mode deployment step, and more about how to deploy skywalking with cluster mode, please reference <a href=https://github.com/apache/incubator-skywalking/blob/master/docs/en/Deploy-backend-in-cluster-mode.md>document</a>.</p><h4 id=third-party-components>Third-party components</h4><ol><li>JDK 8+</li><li>Elasticsearch 5.x</li></ol><h4 id=deployment-step>Deployment step</h4><ol><li>Download <a href=http://skywalking.apache.org/downloads/>Apache Skywalking Collector</a></li><li>Deploy Elasticsearch service<ul><li>Set <code>cluster.name</code> to <code>CollectorDBCluster</code></li><li>Set <code>network.host</code> to <code>0.0.0.0</code></li><li>Start elasticsearch service</li></ul></li><li>Unzip and start the Skywalking Collector. Run the ' bin/startup.sh ' command to start skywalking Collector</li></ol><h4 id=deploy-the-demo>Deploy the demo</h4><p>Before you deploy the demo service, please run the following command:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>./mvnw clean package
</code></pre></div><h4 id=deploy-the-provider-service>Deploy the provider service</h4><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>java -jar -javaagent:$AGENT_PATH/skywalking-agent.jar -Dskywalking.agent.application_code=dubbo-provider -Dskywalking.collector.servers=localhost:10800 dubbo-provider/target/dubbo-provider.jar
</code></pre></div><h4 id=deploy-the-consumer-service>Deploy the consumer service</h4><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>java -jar -javaagent:$AGENT_PATH/skywalking-agent.jar -Dskywalking.agent.application_code=dubbo-consumer -Dskywalking.collector.servers=localhost:10800 dubbo-consumer/target/dubbo-consumer.jar 
</code></pre></div><h4 id=visit-demo-service>visit demo service</h4><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>curl http://localhost:8080/sayHello/test
</code></pre></div><h2 id=skywalking-scren-snapshot>Skywalking scren snapshot</h2><h3 id=dashboard>Dashboard</h3><p><img src=/imgs/blog/skywalking-dashboard.png alt=/admin-guide/images/skywalking-dashboard.png></p><h3 id=topology>Topology</h3><p><img src=/imgs/blog/skywalking-topology.png alt=/admin-guide/images/skywalking-topology.png></p><h3 id=application-view>Application view</h3><p><img src=/imgs/blog/skywalking-application.png alt=/admin-guide/images/skywalking-application.png></p><p>JVM Information
<img src=/imgs/blog/skywalking-application_instance.png alt=/admin-guide/images/skywalking-application_instance.png></p><h3 id=service-view>Service view</h3><p>Consumer side
<img src=/imgs/blog/skywalking-service-consumer.png alt=/admin-guide/images/skywalking-service-consumer.png></p><p>provider side
<img src=/imgs/blog/skywalking-service-provider.png alt=/admin-guide/images/skywalking-service-provider.png></p><h3 id=trace>Trace</h3><p><img src=/imgs/blog/skywalking-trace.png alt=/admin-guide/images/skywalking-trace.png></p><p>Span info
<img src=/imgs/blog/skywalking-span-Info.png alt=/admin-guide/images/skywalking-span-Info.png></p><h3 id=alarm-view>Alarm view</h3><p><img src=/imgs/blog/skywalking-alarm.png alt=/admin-guide/images/skywalking-alarm.png></p></div></main></div><div class=col-md-2></div></div></section><footer id=footer role=contentinfo><div class=container><img src=/images/nacos_gray.png><div class=row><div class=col-md-6><h3>Vision</h3><p>By providing an easy-to-use service infrastructure such as dynamic service
discovery, service configuration, service sharing and management and etc., Nacos help users better
construct, deliver and manage their own service platform, reuse and composite business service
faster and deliver value of business innovation more quickly so as to win market for users in the
era of cloud native and in all cloud environments, such as private, mixed, or public clouds.</p></div><div class=col-md-3><dl><dt>Documentation</dt><dd><a href=/en-us/docs/what-is-nacos.html target=_self>Overview</a></dd><dd><a href=/en-us/docs/quick-start.html target=_self>Quick start</a></dd><dd><a href=/en-us/docs/contributing.html target=_self>Developer guide</a></dd></dl></div><div class=col-md-3><dl><dt>Resources</dt><dd><a href=/en-us/community/index.html target=_self>Community</a></dd><dd><a href="https://cn.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target=_self>Cloud Service MSE</a></dd><dd><a href="https://www.aliyun.com/product/edas?source_type=nacos_pc_20181219" target=_self>Cloud Service EDAS</a></dd><dd><a href="https://www.aliyun.com/product/ahas?source_type=nacos_pc_20190225" target=_self>Cloud Service AHAS</a></dd></dl></div></div><div class="col-md-12 text-center copyright"><span>© 2018 The Nacos Authors | An Alibaba Middleware (Aliware) Project</span></div></div></footer></body><script type=text/javascript>;(function(){$('#fh5co-header').addClass('navbar-fixed-top fh5co-animated slideInDown');$('#nacosLogo').attr("src","/images/nacos_colorful.png")}());</script></html>